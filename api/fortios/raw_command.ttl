message = ''
sendln ''
sendln command
sprintf '%s.*%s' prompt_re command
waitregex inputstr
do
  wait prompt 'Unknown action' 'Command fail'
  if result == 1 then
    break
  elseif result > 1 then
    message = '(FortiOS) command error: '
    strconcat message command
    include 'lib\sys\log.ttl'
    recvln
    message = inputstr
    include 'lib\sys\log.ttl'
  endif
loop while 1
sendln ''
